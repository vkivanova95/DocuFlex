{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="card shadow-sm p-4">
<h4 class="custom-header mb-4">–í—Å–∏—á–∫–∏ –∑–∞—è–≤–∫–∏</h4>
    {% include 'pagination_control.html' %}
<div class="row">
    <form method="get" class="row g-3 mb-4">
    <div class="col-md-3">
        <input type="text" name="request_number" value="{{ filters.request_number }}" class="form-control" placeholder="–ó–∞—è–≤–∫–∞ ‚Ññ">
    </div>
    <div class="col-md-2">
        <input type="text" name="eik" value="{{ filters.eik }}" class="form-control" placeholder="–ï–ò–ö">
    </div>
    <div class="col-md-2">
        <input type="text" name="contract" value="{{ filters.contract }}" class="form-control" placeholder="‚Ññ –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä">
    </div>
    <div class="col-md-2">
    <select name="document_type" class="form-select">
        <option value="">-- –í—Å–∏—á–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ --</option>
        <option value="standard" {% if filters.document_type == "standard" %}selected{% endif %}>–°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –∞–Ω–µ–∫—Å</option>
        <option value="deletion" {% if filters.document_type == "deletion" %}selected{% endif %}>–ê–Ω–µ–∫—Å –∑–∞ –∑–∞–ª–∏—á–∞–≤–∞–Ω–µ</option>
    </select>
    </div>
<p>

</p>
<div class="row">
    <div class="col-md-3">
        <select name="maker" class="form-select">
            <option value="">-- –í—Å–∏—á–∫–∏ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ–ª–∏ --</option>
            {% for maker in makers %}
                <option value="{{ maker.id }}" {% if maker.id|stringformat:"s" == filters.maker %}selected{% endif %}>
                    {{ maker.get_full_name|default:maker.username }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="col-md-3">
    <select name="status" class="form-select">
        <option value="">-- –í—Å–∏—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∏ --</option>
        <option value="in_progress" {% if filters.status == "in_progress" %}selected{% endif %}>–í –ø—Ä–æ—Ü–µ—Å –Ω–∞ —Ä–∞–±–æ—Ç–∞</option>
        <option value="signed" {% if filters.status == "signed" %}selected{% endif %}>–ü–æ–¥–ø–∏—Å–∞–Ω</option>
        <option value="rejected" {% if filters.status == "rejected" %}selected{% endif %}>–û—Ç–∫–∞–∑–∞–Ω</option>
    </select>
    </div>
    <input type="hidden" name="per_page" value="{{ per_page }}">
    <div class="col-md-2">
        <button type="submit" class="btn btn-outline-primary w-100">üîç –¢—ä—Ä—Å–∏</button>
    </div>
    <div class="col-md-2">
        <a href="{% url 'requests:request_list_all' %}" class="btn btn-outline-danger w-100">‚úñ –ò–∑—á–∏—Å—Ç–∏</a>
    </div>

</form>
<p>

</p>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>‚Ññ</th>
            <th>–ö–ª–∏–µ–Ω—Ç</th>
            <th>–ï–ò–ö</th>
            <th>–î–æ–≥–æ–≤–æ—Ä</th>
            <th>–î–æ–∫—É–º–µ–Ω—Ç</th>
            <th>–ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
        </tr>
    </thead>
    <tbody>
        {% for req in requests %}
        <tr onclick="location.href='{% url 'requests:request_view' req.id %}'" style="cursor:pointer;">
            <td>{{ req.request_number }}</td>
            <td>{{ req.client.name }}</td>
            <td>{{ req.client.eik }}</td>
            <td>{{ req.loan_agreement.contract_number }}</td>
            <td>{{ req.get_document_type_display }}</td>
            <td>{{ req.maker.get_full_name|default:"-" }}</td>
            <td>{{ req.get_status_display|default:"-" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">–ù—è–º–∞ –≤—ä–≤–µ–¥–µ–Ω–∏ –∑–∞—è–≤–∫–∏.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<p>

</p>
</div>
{% include "pagination.html" with page_obj=page_obj %}
{% endblock %}
