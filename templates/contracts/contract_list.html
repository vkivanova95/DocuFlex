{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="card shadow-sm p-4">
    <h4 class="custom-header"> –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–∏</h4>

 <form method="get" class="mb-3 d-flex justify-content-end align-items-center gap-2">
        <label for="per_page" class="form-label mb-0">–ü–æ–∫–∞–∂–∏ –ø–æ:</label>
        <select name="per_page" id="per_page" class="form-select w-auto" onchange="this.form.submit()">
            <option value="5" {% if request.GET.per_page == '5' %}selected{% endif %}>5</option>
            <option value="10" {% if request.GET.per_page == '10' or not request.GET.per_page %}selected{% endif %}>10</option>
            <option value="20" {% if request.GET.per_page == '20' %}selected{% endif %}>20</option>
            <option value="all" {% if request.GET.per_page == 'all' %}selected{% endif %}>–í—Å–∏—á–∫–∏</option>
        </select>
</form>

<form method="get" class="mb-3 d-flex justify-content-end">
        <input type="text" name="search" value="{{ search_query }}" class="form-control me-2" placeholder="–¢—ä—Ä—Å–∏ –ø–æ –ï–ò–ö –∏–ª–∏ –ù–æ–º–µ—Ä –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä">
        <button type="submit" class="btn btn-primary">üîç</button>
    </form>

<table class="table table-striped">
  <thead>
    <tr>
      <th>–î–æ–≥–æ–≤–æ—Ä ‚Ññ</th>
      <th>–î–∞—Ç–∞</th>
      <th>–í–∞–ª—É—Ç–∞</th>
      <th>–°—É–º–∞</th>
      <th>–ò–º–µ</th>
      <th>–ï–ò–ö</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
  </thead>
  <tbody>
    {% for contract in contracts %}
      <tr>
        <td>{{ contract.contract_number }}</td>
        <td>{{ contract.start_date }}</td>
        <td>{{ contract.currency }}</td>
        <td>{{ contract.amount }}</td>
        <td>{{ contract.client.name }}</td>
        <td>{{ contract.client.eik }}</td>
        <td>
          {% if contract.is_active %}
            <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
          {% else %}
            <span class="badge bg-secondary">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
          {% endif %}
        </td>
        <td>
          <a href="{% url 'contracts:contract_edit' contract.pk %}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ü–∏—è</a>
          <form method="post" action="{% url 'contracts:deactivate' contract.pk %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('–ù–∞–∏—Å—Ç–∏–Ω–∞ –ª–∏ –∏—Å–∫–∞—Ç–µ –¥–∞ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–∞—Ç–µ —Ç–æ–∑–∏ –¥–æ–≥–æ–≤–æ—Ä?')">üóëÔ∏è –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è</button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5">–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –¥–æ–≥–æ–≤–æ—Ä–∏.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% include "pagination.html" with page_obj=page_obj %}
</div>
{% endblock %}
