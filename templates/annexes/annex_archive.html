{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
  <div class="card shadow-sm p-4">
    <h4 class="custom-header">–†–µ–≥–∏—Å—Ç—ä—Ä –Ω–∞ –∏–∑–≥–æ—Ç–≤–µ–Ω–∏—Ç–µ –∞–Ω–µ–∫—Å–∏</h4>

      <form method="get" class="mb-3 d-flex justify-content-end align-items-center gap-2">
        <label for="per_page" class="form-label mb-0">–ü–æ–∫–∞–∂–∏ –ø–æ:</label>
        <select name="per_page" id="per_page" class="form-select w-auto" onchange="this.form.submit()">
            <option value="5" {% if request.GET.per_page == '5' %}selected{% endif %}>5</option>
            <option value="10" {% if request.GET.per_page == '10' or not request.GET.per_page %}selected{% endif %}>10</option>
            <option value="20" {% if request.GET.per_page == '20' %}selected{% endif %}>20</option>
            <option value="all" {% if request.GET.per_page == 'all' %}selected{% endif %}>–í—Å–∏—á–∫–∏</option>
        </select>
    </form>

      <form method="get" class="row g-2 mb-4">
      <div class="col-md-2">
        <input type="text" name="request_number" value="{{ filters.request_number }}" class="form-control" placeholder="–ó–∞—è–≤–∫–∞ ‚Ññ">
      </div>
      <div class="col-md-2">
        <input type="text" name="eik" value="{{ filters.eik }}" class="form-control" placeholder="–ï–ò–ö">
      </div>
      <div class="col-md-2">
        <input type="text" name="contract_number" value="{{ filters.contract_number }}" class="form-control" placeholder="–î–æ–≥–æ–≤–æ—Ä ‚Ññ">
      </div>


      <div class="col-md-12 text-end mt-2">
        <button type="submit" class="btn btn-outline-secondary">üîç –¢—ä—Ä—Å–∏</button>
        <a href="{% url 'annexes:annex_archive' %}" class="btn btn-outline-danger">‚úñ –ò–∑—á–∏—Å—Ç–∏</a>
      </div>
    </form>

    <table class="table table-bordered table-hover">
      <thead class="table-light">
        <tr>
          <th>–ó–∞—è–≤–∫–∞ ‚Ññ</th>
          <th>–ö–ª–∏–µ–Ω—Ç</th>
          <th>–ï–ò–ö</th>
          <th>–î–æ–≥–æ–≤–æ—Ä ‚Ññ</th>
          <th>–ê–Ω–µ–∫—Å ‚Ññ</th>
          <th>–î–∞—Ç–∞ –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ</th>
          <th>–ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª</th>
          <th>–õ–∏–Ω–∫</th>
        </tr>
      </thead>
      <tbody>
        {% for annex in annexes %}
        <tr>
          <td>{{ annex.request.request_number }}</td>
          <td>{{ annex.request.client.name }}</td>
          <td>{{ annex.request.client.eik }}</td>
          <td>{{ annex.request.loan_agreement.contract_number }}</td>
          <td>{{ annex.annex_number }}</td>
          <td>{{ annex.created_at|date:"d.m.Y H:i" }}</td>
          <td>{{ annex.request.maker.get_full_name|default:annex.request.maker.username }}</td>
          <td>
            <a href="{{ annex.file_path.url }}" target="_blank" class="btn btn-outline-secondary mb-2">–ü—Ä–µ–≥–ª–µ–¥</a>
            <a href="{% url 'api:send_annex' pk=annex.id %}" class="btn btn-outline-danger">üìù –ò–∑–ø—Ä–∞—Ç–∏ –∑–∞ –ø–æ–¥–ø–∏—Å</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">–ù—è–º–∞ –∞–Ω–µ–∫—Å–∏ –ø–æ –∑–∞–¥–∞–¥–µ–Ω–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <p>

    </p>
    {% include "pagination.html" with page_obj=page_obj %}

  </div>
</div>
{% endblock %}
