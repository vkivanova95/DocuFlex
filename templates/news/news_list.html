{% extends 'base.html' %}
{% block content %}
{% load group_tags %}

<div class="card shadow-sm p-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="custom-header">–í—Å–∏—á–∫–∏ –Ω–æ–≤–∏–Ω–∏</h4>
        {% if request.user|has_group:"—Ä—ä–∫–æ–≤–æ–¥–∏—Ç–µ–ª" or request.user.is_superuser %}
            <a href="{% url 'news:add_news' %}" class="btn btn-primary">–î–æ–±–∞–≤–∏ –Ω–æ–≤–∏–Ω–∞</a>
        {% endif %}
    </div>
    {% include 'pagination_control.html' %}

    <form method="get" class="d-flex flex-wrap align-items-center gap-2 mb-3">
        <input type="text" name="q" class="form-control w-auto" placeholder="–¢—ä—Ä—Å–∏ –ø–æ –∑–∞–≥–ª–∞–≤–∏–µ"
               value="{{ q }}">
        <input type="hidden" name="per_page" value="{{ per_page }}">
        <button type="submit" class="btn btn-outline-primary">üîç –¢—ä—Ä—Å–∏</button>
        <a href="{% url 'news:news_list' %}" class="btn btn-outline-danger">‚ùå –ò–∑—á–∏—Å—Ç–∏</a>
    </form>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>–ó–∞–≥–ª–∞–≤–∏–µ</th>
                <th>–î–∞—Ç–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for post in news_posts %}
            <tr>
                <td>{{ post.title }}</td>
                <td>{{ post.published_at|date:"d.m.Y H:i" }}</td>
                <td>
                    {% if post.is_active %}
                        <span class="badge bg-success">–ê–∫—Ç–∏–≤–Ω–∞</span>
                    {% else %}
                        <span class="badge bg-secondary">–ù–µ–∞–∫—Ç–∏–≤–Ω–∞</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'news:edit_news' post.pk %}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ü–∏—è</a>
                    <form method="post" action="{% url 'news:deactivate_news' post.pk %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('–î–∞ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–º–µ –ª–∏ —Ç–∞–∑–∏ –Ω–æ–≤–∏–Ω–∞?')">üóëÔ∏è –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">–ù—è–º–∞ –ø—É–±–ª–∏–∫—É–≤–∞–Ω–∏ –Ω–æ–≤–∏–Ω–∏.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% include "pagination.html" with page_obj=page_obj %}
</div>
{% endblock %}
